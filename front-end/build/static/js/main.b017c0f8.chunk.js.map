{"version":3,"sources":["components/Icon.js","components/Nav.js","Keyboard.js","unit.js","components/Controller.js","components/AiSample.js","components/AiDrive.js","components/AiTrain.js","components/Ai.js","lib/CocoSSD.js","components/ObjectDetection.js","components/Setting.js","components/Login.js","App.js","serviceWorker.js","index.js"],"names":["Icon","createFromIconfontCN","scriptUrl","Nav","props","mode","SubMenu","key","icon","CarOutlined","title","Item","to","process","SettingOutlined","href","target","rel","type","YoutubeOutlined","GithubOutlined","WeiboOutlined","Keybord","handleKeyDown","event","controller","speed","direction","onControl","keyName","handleKeyUp","keyboardBind","window","document","addEventListener","ref","createRef","this","removeEventListener","Component","layout","labelCol","span","wrapperCol","tailLayout","offset","loadTruncatedMobileNet","a","tf","mobilenet","layer","getLayer","inputs","outputs","output","getImageUrl","canvas","smallCanvas","getElementById","createElement","id","width","height","img","fromPixels","smallImg","resizeNearestNeighbor","toPixels","toDataURL","imageUrlToImg","dataURL","Promise","resolve","Image","src","Ai","truncatedMobileNet","url","lable","data","oImg","expandDims","toFloat","div","sub","example","predict","dispose","y","toInt","xs","ys","oldX","concat","oldY","learnArgument","lossCallBack","console","log","Error","model","layers","flatten","inputShape","shape","slice","dense","units","hiddenUnits","activation","kernelInitializer","useBias","optimizer","adam","learnRate","compile","loss","batchSize","Math","floor","fit","epochs","callbacks","onBatchEnd","batch","logs","toFixed","embeddings","predictions","probability","predictedClass","as1D","argMax","label","name","save","sleep","time","setTimeout","vibrate","v","navigator","curentOrientation","aiAction","left","ArrowLeftOutlined","action","right","ArrowRightOutlined","forward","ArrowUpOutlined","back","ArrowDownOutlined","stop","PauseOutlined","AiSample","clear","setState","sampleList","upload","file","onSuccess","reader","FileReader","onload","result","JSON","parse","state","readAsText","download","exportName","saveAs","Blob","stringify","changeCamera","canvasRef","unshift","index","splice","onFinish","cameraEnabled","className","Object","keys","map","onClick","add","disabled","customRequest","accept","showUploadList","ImportOutlined","ExportOutlined","length","size","grid","gutter","column","itemLayout","pagination","pageSize","dataSource","renderItem","actions","CloseOutlined","remove","style","alt","onLoad","AiDrive","doSometing","ai","onAi","isPredicting","actionKey","labelToKey","interval","test","drive","loadModel","load","message","success","downloadModel","find","value","onChange","loading","BugOutlined","StopOutlined","Option","Select","AiTrain","train","clean","addExample","undefined","smallCanvasRef","spinning","tip","initialValues","ReadOutlined","htmlType","menu","AiView","menuItem","learnForm","exampleList","path","selectedKeys","match","current","i","CocoSSD","cocoSsd","base","image","detect","timeEnd","ObjectDetection","targetClass","threshold","detectionList","draw","cocoSSD","forEach","some","c","class","push","score","context","getContext","clearRect","font","beginPath","rect","bbox","lineWidth","strokeStyle","fillStyle","stroke","fillText","startDetect","detecting","driving","x","w","start","videoSize","padding","opacity","transform","isSupportedOrientaion","e","alpha","beta","gamma","Controller","gamepadConnected","gamepad","gamepadEnabled","gamepadPress","detail","lightEnabled","changeLight","forwardPower","fixedController","gamepadAxis","gamePadsLoop","buttonsStatus","axesStatus","gamePadsTime","setInterval","gamepadList","getGamepads","webkitGetGamepads","gamePadIndex","axes","buttons","connected","status","dispatchEvent","CustomEvent","deviceorientation","directionReverse","isAiControlling","zeroOrientation","bateDegree","backwardPower","speedReverse","directionFix","fixContent","display","AimOutlined","checked","store","set","min","max","included","get","isShowButton","mobile","gamepadDisconnected","clearInterval","handleSetZeroOrientation","error","content","trigger","SlidersOutlined","onTouchStart","onTouchEnd","LeftOutlined","RightOutlined","UpOutlined","DownOutlined","placement","arrowPointAtCenter","checkedChildren","DragOutlined","unCheckedChildren","Setting","onDisconnect","wsConnected","onSubmit","serverSetting","form","rules","required","maxSpeed","tooltipVisible","Login","App","connect","wsAddress","setting","wsavc","location","protocol","disconnect","preventDefault","login","password","send","token","md5","enabled","cameraMode","enable","changeSetting","navigate","changeZeroSpeedRate","speedZeroRate","changeSpeed","speedRate","changeDirection","directionRate","appRef","playerBoxRef","speedMax","host","isFullscreen","delay","changeVideoSize","debounce","unbounceVideoSize","pingTime","WSAvcPlayer","useWorker","workerFile","on","sendTime","Date","getTime","needPassword","fbl","payload","appendChild","AvcPlayer","m","body","fullscreenElement","Button","overlay","HomeOutlined","ApiOutlined","VideoCameraOutlined","defaultValue","step","tipFormatter","onAfterChange","marks","0","50","100","ExpandOutlined","BulbOutlined","requestFullscreen","FullscreenExitOutlined","FullscreenOutlined","exitFullscreen","color","preventSleep","Boolean","hostname","ReactDOM","render","StrictMode","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.b017c0f8.chunk.js","sourcesContent":["import { createFromIconfontCN } from '@ant-design/icons';\n\nconst Icon= createFromIconfontCN({\n  scriptUrl: '//at.alicdn.com/t/font_1773709_52px07fzrwt.js',\n});\n\nexport default Icon  ","import React from \"react\";\nimport { Menu } from \"antd\";\nimport { Link } from \"@reach/router\";\nimport {\n  GithubOutlined,\n  YoutubeOutlined,\n  WeiboOutlined,\n  SettingOutlined,\n  CarOutlined,\n} from \"@ant-design/icons\";\nimport Icon from \"./Icon\";\n\nexport default function Nav(props) {\n  return (\n    <Menu mode=\"horizontal\" {...props}>\n      <Menu.SubMenu key=\"sub2\" icon={<CarOutlined />} title=\"AI\">\n        <Menu.Item>\n          <Link to={`${process.env.PUBLIC_URL}/ai/learn/sample`}>机器学习</Link>\n        </Menu.Item>\n        <Menu.Item>\n          <Link to={`${process.env.PUBLIC_URL}/ai/coco-ssd`}>目标追踪</Link>\n        </Menu.Item>\n      </Menu.SubMenu>\n      <Menu.Item>\n        <Link to={`${process.env.PUBLIC_URL}/setting`}>\n          <SettingOutlined /> 设置\n        </Link>\n      </Menu.Item>\n\n      <Menu.Item>\n        <a\n          href=\"https://space.bilibili.com/96740361\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          <Icon type=\"icon-bilibili-fill\" /> B站 EsonWong\n        </a>\n      </Menu.Item>\n      <Menu.Item>\n        <a\n          href=\"https://www.youtube.com/channel/UCyQR6LHhhhpTFfxZo7VZddA\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          <YoutubeOutlined /> Youtube EsonWong\n        </a>\n      </Menu.Item>\n      <Menu.Item>\n        <a\n          href=\"https://github.com/itiwll/network-rc\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          <GithubOutlined /> Github Network-rc\n        </a>\n      </Menu.Item>\n      <Menu.Item>\n        <a\n          href=\"https://weibo.com/u/5034944416\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          <WeiboOutlined /> 微博 Eson_Wong\n        </a>\n      </Menu.Item>\n      {/* <Menu.Item>\n        <Link to=\"ai\">Ai</Link>\n      </Menu.Item> */}\n    </Menu>\n  );\n}\n","import React, { Component, createRef } from \"react\";\n\nexport default class Keybord extends Component {\n  constructor(props) {\n    super(props);\n    this.ref = createRef();\n  }\n\n  componentDidMount() {\n    this.keyboardBind();\n  }\n\n  componentWillUnmount() {\n    const { handleKeyDown, handleKeyUp } = this;\n    window.document.removeEventListener(\"keydown\", handleKeyDown, false);\n    window.document.removeEventListener(\"keyup\", handleKeyUp, false);\n  }\n\n  handleKeyDown = (event) => {\n    const {\n      props: {\n        controller: { speed, direction },\n        onControl,\n      },\n    } = this;\n    const keyName = event.key;\n    if (keyName === \"w\") {\n      speed(1);\n    }\n    if (keyName === \"s\") {\n      speed(-1);\n    }\n    if (keyName === \"a\") {\n      direction(1);\n    }\n    if (keyName === \"d\") {\n      direction(-1);\n    }\n    onControl && onControl();\n  };\n\n  handleKeyUp = (event) => {\n    const {\n      props: {\n        controller: { speed, direction },\n        onControl,\n      },\n    } = this;\n    const keyName = event.key;\n    if (keyName === \"w\") {\n      speed(0);\n    }\n    if (keyName === \"s\") {\n      speed(0);\n    }\n    if (keyName === \"a\") {\n      direction(0);\n    }\n    if (keyName === \"d\") {\n      direction(0);\n    }\n    onControl && onControl();\n  };\n\n  keyboardBind = () => {\n    const { handleKeyDown, handleKeyUp } = this;\n    window.document.addEventListener(\"keydown\", handleKeyDown, false);\n    window.document.addEventListener(\"keyup\", handleKeyUp, false);\n  };\n\n  render() {\n    return <div></div>;\n  }\n}\n","import * as tf from \"@tensorflow/tfjs\";\n\nexport const layout = {\n  labelCol: {\n    span: 6,\n  },\n  wrapperCol: {\n    span: 16,\n  },\n};\n\nexport const tailLayout = {\n  wrapperCol: { offset: 6, span: 16 },\n};\n\nexport const marks = {\n  0: \"0%\",\n  25: \"25%\",\n  50: \"50%\",\n  75: \"75%\",\n  100: \"100%\",\n};\n\nexport async function loadTruncatedMobileNet() {\n  const mobilenet = await tf.loadLayersModel(\n    \"https://storage.googleapis.com/tfjs-models/tfjs/mobilenet_v1_1.0_224/model.json\"\n  );\n  // Return a model that outputs an internal activation.\n  const layer = mobilenet.getLayer(\"conv_pw_13_relu\");\n  return tf.model({ inputs: mobilenet.inputs, outputs: layer.output });\n}\n\nexport async function getImageUrl(canvas) {\n  let smallCanvas = document.getElementById(\"small-canvas\");\n  if (!smallCanvas) {\n    smallCanvas = document.createElement(\"canvas\");\n    smallCanvas.id = \"small-canvas\";\n    smallCanvas.width = 224;\n    smallCanvas.height = 224;\n  }\n  const img = tf.browser.fromPixels(canvas);\n  const smallImg = img.resizeNearestNeighbor([224, 224]);\n  await tf.browser.toPixels(smallImg, smallCanvas);\n  return smallCanvas.toDataURL();\n}\n\nexport async function imageUrlToImg(dataURL) {\n  return await new Promise((resolve) => {\n    const img = new Image();\n    img.addEventListener(\"load\", () => {\n      resolve(tf.browser.fromPixels(img));\n    });\n    img.src = dataURL;\n  });\n}\n\nconst NUM_CLASSES = 5;\nexport class Ai {\n  constructor() {\n    return (async () => {\n      this.truncatedMobileNet = await loadTruncatedMobileNet();\n      return this;\n    })();\n  }\n\n  /**\n   * Adds an example to the controller dataset.\n   * @param {Tensor} example A tensor representing the example. It can be an image,\n   *     an activation, or any other type of Tensor.\n   * @param {[number]} action speed and direction.\n   */\n  async addExample(url, lable) {\n    const data = await imageUrlToImg(url);\n    const oImg = tf.tidy(() => data.expandDims(0).toFloat().div(127).sub(1));\n    const example = this.truncatedMobileNet.predict(oImg);\n    oImg.dispose();\n    const y = tf.tidy(() =>\n      tf.oneHot(tf.tensor1d([lable]).toInt(), NUM_CLASSES)\n    );\n\n    if (this.xs == null) {\n      // For the first example that gets added, keep example and y so that the\n      // ControllerDataset owns the memory of the inputs. This makes sure that\n      // if addExample() is called in a tf.tidy(), these Tensors will not get\n      // disposed.\n      this.xs = tf.keep(example);\n      this.ys = tf.keep(y);\n    } else {\n      const oldX = this.xs;\n      this.xs = tf.keep(oldX.concat(example, 0));\n\n      const oldY = this.ys;\n      this.ys = tf.keep(oldY.concat(y, 0));\n\n      oldX.dispose();\n      oldY.dispose();\n      y.dispose();\n    }\n  }\n  clean() {\n    if (!this.xs) return;\n    this.xs.dispose();\n    this.ys.dispose();\n    this.xs = null;\n    this.ys = null;\n  }\n\n  async train(learnArgument, lossCallBack) {\n    console.log(\"Learnning Argument\", learnArgument);\n    if (this.xs == null) {\n      throw new Error(\"Add some examples before training!\");\n    }\n\n    // Creates a 2-layer fully connected model. By creating a separate model,\n    // rather than adding layers to the mobilenet model, we \"freeze\" the weights\n    // of the mobilenet model, and only train weights from the new model.\n    const model = tf.sequential({\n      layers: [\n        // Flattens the input to a vector so we can use it in a dense layer. While\n        // technically a layer, this only performs a reshape (and has no training\n        // parameters).\n        tf.layers.flatten({\n          inputShape: this.truncatedMobileNet.outputs[0].shape.slice(1),\n        }),\n        // Layer 1.\n        tf.layers.dense({\n          units: learnArgument.hiddenUnits,\n          activation: \"relu\",\n          kernelInitializer: \"varianceScaling\",\n          useBias: true,\n        }),\n        // Layer 2. The number of units of the last layer should correspond\n        // to the number of classes we want to predict.\n        tf.layers.dense({\n          units: NUM_CLASSES,\n          kernelInitializer: \"varianceScaling\",\n          useBias: false,\n          activation: \"softmax\",\n        }),\n      ],\n    });\n\n    // Creates the optimizers which drives training of the model.\n    const optimizer = tf.train.adam(learnArgument.learnRate);\n    // We use categoricalCrossentropy which is the loss function we use for\n    // categorical classification which measures the error between our predicted\n    // probability distribution over classes (probability that an input is of each\n    // class), versus the label (100% probability in the true class)>\n    model.compile({ optimizer: optimizer, loss: \"categoricalCrossentropy\" });\n\n    // We parameterize batch size as a fraction of the entire dataset because the\n    // number of examples that are collected depends on how many examples the user\n    // collects. This allows us to have a flexible batch size.\n    const batchSize = Math.floor(this.xs.shape[0] * learnArgument.batchSize);\n    if (!(batchSize > 0)) {\n      throw new Error(\n        `Batch size is 0 or NaN. Please choose a non-zero fraction.`\n      );\n    }\n\n    // Train the model! Model.fit() will shuffle xs & ys so we don't have to.\n    await model.fit(this.xs, this.ys, {\n      batchSize,\n      epochs: learnArgument.epochs,\n      callbacks: {\n        onBatchEnd: async (batch, logs) => {\n          console.log(\"Loss: \" + logs.loss.toFixed(5));\n          lossCallBack(logs.loss.toFixed(5));\n        },\n      },\n    });\n\n    this.model = model;\n\n    return model;\n  }\n\n  async predict(canvas) {\n    const img = tf.tidy(() =>\n      tf.browser\n        .fromPixels(canvas)\n        .resizeNearestNeighbor([224, 224])\n        .expandDims(0)\n        .toFloat()\n        .div(127)\n        .sub(1)\n    );\n\n    // Make a prediction through mobilenet, getting the internal activation of\n    // the mobilenet model, i.e., \"embeddings\" of the input images.\n    const embeddings = this.truncatedMobileNet.predict(img);\n\n    // Make a prediction through our newly-trained model using the embeddings\n    // from mobilenet as input.\n    const predictions = this.model.predict(embeddings);\n    let probability = await predictions.data();\n\n    // Returns the index with the maximum probability. This number corresponds\n    // to the class the model thinks is the most probable given the input.\n    const predictedClass = predictions.as1D().argMax();\n    const label = (await predictedClass.data())[0];\n    console.log(\"Ai 预测:\", probability);\n    img.dispose();\n    await tf.nextFrame();\n    return { label, probability: probability[label] };\n  }\n\n  async save(name) {\n    await this.model.save(`indexeddb://${name}`);\n  }\n\n  async load(name) {\n    this.model = await tf.loadLayersModel(`indexeddb://${name}`);\n  }\n}\n\nexport async function sleep(time) {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve();\n    }, time);\n  });\n}\n\nexport function vibrate(v) {\n  navigator.vibrate && navigator.vibrate(v);\n}\n","import React, { Component, Fragment } from \"react\";\nimport { Form, Button, Switch, Slider, Popover, message, Tag } from \"antd\";\nimport { SlidersOutlined, DragOutlined } from \"@ant-design/icons\";\nimport {\n  AimOutlined,\n  DownOutlined,\n  UpOutlined,\n  LeftOutlined,\n  RightOutlined,\n} from \"@ant-design/icons\";\nimport store from \"store\";\nimport Keybord from \"../Keyboard\";\nimport { vibrate } from \"../unit\";\nimport Icon from \"./Icon\";\nimport Ai from \"./Ai\";\nimport mobile from \"is-mobile\";\nimport { Router } from \"@reach/router\";\nimport ObjectDetection from \"./ObjectDetection\";\n\nlet curentOrientation;\nlet isSupportedOrientaion = false;\nconst deviceorientation = (e) => {\n  const { alpha, beta, gamma } = e;\n  curentOrientation = { alpha, beta, gamma };\n  if (alpha || isSupportedOrientaion) {\n    isSupportedOrientaion = true;\n  }\n};\n\nwindow.addEventListener(\"deviceorientation\", deviceorientation);\n\nexport default class Controller extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      zeroOrientation: undefined,\n      directionReverse: store.get(\"directionReverse\") || false,\n      speedReverse: store.get(\"speedReverse\") || false,\n      backwardPower: 50,\n      forwardPower: 50,\n      directionFix: store.get(\"directionFix\") || 0,\n      isShowButton: mobile(),\n      gamepadEnabled: false,\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"deviceorientation\", this.deviceorientation);\n    window.addEventListener(\"gamepadconnected\", this.gamepadConnected);\n    window.addEventListener(\"gamepaddisconnected\", this.gamepadDisconnected);\n    window.addEventListener(\"gamepadpress\", this.gamepadPress);\n    window.addEventListener(\"gamepadaxis\", this.gamepadAxis);\n    this.gamePadsLoop();\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.gamePadsTime);\n    window.removeEventListener(\"deviceorientation\", this.deviceorientation);\n    window.removeEventListener(\"gamepadconnected\", this.gamepadConnected);\n    window.removeEventListener(\"gamepaddisconnected\", this.gamepadDisconnected);\n    window.removeEventListener(\"gamepadpress\", this.gamepadPress);\n    window.removeEventListener(\"gamepadaxis\", this.gamepadAxis);\n    window.removeEventListener(\n      \"deviceorientation\",\n      this.handleSetZeroOrientation\n    );\n  }\n\n  gamepadConnected = (e) => {\n    const {\n      gamepad: { index, id },\n    } = e;\n    message.success(`控制器已连接于 ${index} 位: ${id}。`);\n    this.setState({ gamepadEnabled: true });\n  };\n  gamepadDisconnected(e) {\n    const {\n      gamepad: { index, id },\n    } = e;\n    message.error(`控制器位${id}-${index}已断开。`);\n  }\n\n  gamepadPress = ({ detail: { index, value } }) => {\n    const {\n      lightEnabled,\n      cameraEnabled,\n      controller: { changeLight, changeCamera },\n    } = this.props;\n    let { forwardPower } = this.state;\n    const {\n      fixedController: { speed, direction },\n    } = this;\n    if (index === 1 || index === 13 || index === 6) {\n      speed(value * -1);\n    }\n    if (index === 0 || index === 12 || index === 7) {\n      speed(value);\n    }\n    if (index === 14) {\n      direction(value * -1);\n    }\n    if (index === 15) {\n      direction(value);\n    }\n    if (index === 9 && value === 1) {\n      changeLight(!lightEnabled);\n    }\n    if (index === 16 && value === 1) {\n      changeCamera(!cameraEnabled);\n    }\n\n    if ((index === 4 || index === 2) && value === 1) {\n      forwardPower -= 5;\n      if (forwardPower < 0) forwardPower = 0;\n      this.setState({ forwardPower });\n    }\n    if ((index === 3 || index === 5) && value === 1) {\n      forwardPower += 5;\n      if (forwardPower > 100) forwardPower = 100;\n      this.setState({ forwardPower });\n    }\n  };\n\n  gamepadAxis = ({ detail: { index, value } }) => {\n    const {\n      fixedController: { speed, direction },\n    } = this;\n    if (index === 0) {\n      direction(-value);\n    }\n    if (index === 3) {\n      speed(-value);\n    }\n  };\n\n  gamePadsLoop = () => {\n    const buttonsStatus = {},\n      axesStatus = {};\n    this.gamePadsTime = setInterval(() => {\n      const gamepadList = navigator.getGamepads\n        ? navigator.getGamepads()\n        : navigator.webkitGetGamepads\n        ? navigator.webkitGetGamepads\n        : [];\n      for (\n        let gamePadIndex = 0;\n        gamePadIndex < gamepadList.length;\n        gamePadIndex++\n      ) {\n        const gamepad = gamepadList[gamePadIndex];\n        if (!gamepad) continue;\n        const { axes, buttons, connected } = gamepad;\n        if (!connected) continue;\n        buttons.forEach((status, index) => {\n          if (!buttonsStatus[`${gamePadIndex}-${index}`]) {\n            buttonsStatus[`${gamePadIndex}-${index}`] = status;\n            return;\n          }\n          if (\n            buttonsStatus[`${gamePadIndex}-${index}`].value !== status.value\n          ) {\n            window.dispatchEvent(\n              new CustomEvent(\"gamepadpress\", {\n                detail: { index, value: status.value },\n              })\n            );\n          }\n          buttonsStatus[`${gamePadIndex}-${index}`] = status;\n        });\n        axes.forEach((value, index) => {\n          if (!axesStatus[`${gamePadIndex}-${index}`]) {\n            axesStatus[`${gamePadIndex}-${index}`] = { value };\n            return;\n          }\n          if (axesStatus[`${gamePadIndex}-${index}`].value !== value) {\n            window.dispatchEvent(\n              new CustomEvent(\"gamepadaxis\", {\n                detail: { index, value },\n              })\n            );\n          }\n          axesStatus[`${gamePadIndex}-${index}`] = { value };\n        });\n      }\n    }, 50);\n  };\n\n  deviceorientation = ({ alpha, beta, gamma }) => {\n    const {\n      props: { controller },\n      state: { directionReverse, isAiControlling, zeroOrientation },\n    } = this;\n    if (!zeroOrientation) return;\n    if (isAiControlling) return;\n    const { beta: baseBeta } = zeroOrientation;\n    let bateDegree = beta - baseBeta;\n    bateDegree = bateDegree < -30 ? -30 : bateDegree;\n    bateDegree = bateDegree > 30 ? 30 : bateDegree;\n    controller.direction((bateDegree / 30) * (directionReverse ? -1 : 1));\n  };\n\n  fixedController = {\n    speed: (v) => {\n      const {\n        props: {\n          controller: { speed },\n        },\n        state: { forwardPower, backwardPower, speedReverse },\n      } = this;\n      speed(\n        v *\n          (speedReverse ? -1 : 1) *\n          ((v > 0 ? forwardPower : backwardPower) / 100)\n      );\n    },\n    direction: (v) => {\n      const {\n        props: {\n          controller: { direction },\n        },\n        state: { directionReverse, directionFix },\n      } = this;\n      direction(v * (directionReverse ? -1 : 1) + directionFix);\n    },\n    changeCamera: (v) => this.props.controller.changeCamera(v),\n  };\n\n  fixContent = () => {\n    const { directionReverse, speedReverse, directionFix } = this.state;\n    return (\n      <Form>\n        <Form.Item\n          style={{ display: isSupportedOrientaion ? undefined : \"none\" }}\n        >\n          <Button\n            type=\"danger\"\n            onClick={() => {\n              this.setState({ zeroOrientation: { ...curentOrientation } });\n            }}\n            icon={<AimOutlined />}\n          >\n            舵机感应校准\n          </Button>\n        </Form.Item>\n        <Form.Item label=\"舵机反向\">\n          <Switch\n            checked={directionReverse}\n            onChange={(v) => {\n              this.setState({\n                directionReverse: v,\n              });\n              store.set(\"directionReverse\", v);\n            }}\n          />\n        </Form.Item>\n        <Form.Item label=\"油门反向\">\n          <Switch\n            checked={speedReverse}\n            onChange={(v) => {\n              this.setState({\n                speedReverse: v,\n              });\n              store.set(\"speedReverse\", v);\n            }}\n          />\n        </Form.Item>\n        <Form.Item label=\"舵机微调\">\n          <Slider\n            value={directionFix * 50 + 50}\n            min={0}\n            max={100}\n            included={false}\n            onChange={(v) => {\n              const directionFix = v / 50 - 1;\n              store.set(\"directionFix\", directionFix);\n              this.setState({ directionFix }, () => {\n                this.fixedController.direction(0);\n              });\n            }}\n            style={{ width: \"50vw\" }}\n          />\n        </Form.Item>\n      </Form>\n    );\n  };\n\n  render() {\n    const {\n      fixContent,\n      fixedController,\n      props: { action, cameraEnabled, canvasRef, videoSize },\n    } = this;\n    const {\n      gamepadEnabled,\n      forwardPower,\n      backwardPower,\n      isShowButton,\n    } = this.state;\n    const { speed, direction } = fixedController;\n    return (\n      <div className=\"controller\">\n        <Form className=\"controller-form\" size=\"small\" layout=\"inline\">\n          <Form.Item>\n            <Popover content={fixContent} title=\"修正\" trigger=\"click\">\n              <Button icon={<SlidersOutlined />}>修正</Button>\n            </Popover>\n          </Form.Item>\n          {isShowButton && (\n            <Fragment>\n              <Button\n                className=\"left-button\"\n                shape=\"circle\"\n                size=\"large\"\n                type=\"primary\"\n                onTouchStart={() => {\n                  direction(1);\n                  vibrate(50);\n                }}\n                onTouchEnd={() => {\n                  direction(0);\n                }}\n                icon={<LeftOutlined />}\n                style={{ display: !isSupportedOrientaion ? undefined : \"none\" }}\n              ></Button>\n              <Button\n                className=\"right-button\"\n                shape=\"circle\"\n                size=\"large\"\n                type=\"primary\"\n                onTouchStart={() => {\n                  direction(-1);\n                  vibrate(50);\n                }}\n                onTouchEnd={() => {\n                  direction(0);\n                }}\n                icon={<RightOutlined />}\n                style={{ display: !isSupportedOrientaion ? undefined : \"none\" }}\n              ></Button>\n              <Button\n                className=\"forward-button\"\n                shape=\"circle\"\n                size=\"large\"\n                type=\"primary\"\n                onTouchStart={() => {\n                  speed(1);\n                  vibrate(300);\n                }}\n                onTouchEnd={() => {\n                  speed(0);\n                }}\n                icon={<UpOutlined />}\n              ></Button>\n              <Button\n                className=\"backward-button\"\n                shape=\"circle\"\n                size=\"large\"\n                type=\"primary\"\n                onTouchStart={() => {\n                  speed(-1);\n                  vibrate([100, 50, 100]);\n                }}\n                onTouchEnd={() => {\n                  speed(0);\n                }}\n                icon={<DownOutlined />}\n              ></Button>\n            </Fragment>\n          )}\n          <Form.Item>\n            <Popover\n              placement=\"topLeft\"\n              content={\n                <Slider\n                  value={forwardPower}\n                  min={0}\n                  max={100}\n                  onChange={(forwardPower) => {\n                    this.setState({ forwardPower });\n                  }}\n                  arrowPointAtCenter\n                  style={{ width: \"30vw\" }}\n                />\n              }\n            >\n              <Button shape=\"round\">前进油门:{forwardPower}</Button>\n            </Popover>\n          </Form.Item>\n          <Form.Item>\n            <Popover\n              placement=\"topLeft\"\n              content={\n                <Slider\n                  value={backwardPower}\n                  min={0}\n                  max={100}\n                  style={{ width: \"30vw\" }}\n                  onChange={(backwardPower) => {\n                    this.setState({ backwardPower });\n                  }}\n                />\n              }\n            >\n              <Button shape=\"round\">倒退油门:{backwardPower}</Button>\n            </Popover>\n          </Form.Item>\n          <Form.Item>\n            <Switch\n              checked={isShowButton}\n              onChange={(isShowButton) => this.setState({ isShowButton })}\n              checkedChildren={<DragOutlined />}\n              unCheckedChildren={<DragOutlined />}\n            />\n          </Form.Item>\n          <Form.Item>\n            <Switch\n              checked={gamepadEnabled}\n              onChange={(gamepadEnabled) => {\n                if (gamepadEnabled) {\n                  this.gamePadsLoop();\n                } else {\n                  clearInterval(this.gamePadsTime);\n                }\n                this.setState({ gamepadEnabled });\n              }}\n              unCheckedChildren={<Icon type=\"icon-game-\" />}\n              checkedChildren={<Icon type=\"icon-game-\" />}\n            />\n          </Form.Item>\n          <Form.Item>\n            <Tag>键盘:wsad</Tag>\n          </Form.Item>\n        </Form>\n        <Keybord controller={{ speed, direction }} />\n        <Router className=\"controller-router\">\n          <Ai\n            path=\"ai/learn/*\"\n            canvasRef={canvasRef}\n            cameraEnabled={cameraEnabled}\n            action={action}\n            controller={fixedController}\n            onAi={(isAiControlling) => this.setState({ isAiControlling })}\n          />\n          <ObjectDetection\n            path=\"ai/coco-ssd/*\"\n            canvasRef={canvasRef}\n            cameraEnabled={cameraEnabled}\n            action={action}\n            controller={fixedController}\n            onAi={(isAiControlling) => this.setState({ isAiControlling })}\n            videoSize={videoSize}\n          />\n        </Router>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport {\n  ArrowDownOutlined,\n  ArrowLeftOutlined,\n  ArrowRightOutlined,\n  ArrowUpOutlined,\n  PauseOutlined,\n  ImportOutlined,\n  ExportOutlined,\n  CloseOutlined,\n} from \"@ant-design/icons\";\nimport { Form, Button, List, Card, Upload } from \"antd\";\nimport { Link } from \"@reach/router\";\nimport { getImageUrl } from \"../unit\";\nimport { saveAs } from \"file-saver\";\n\nexport const aiAction = {\n  left: {\n    icon: <ArrowLeftOutlined />,\n    name: \"左转弯\",\n    action: { speed: 1, direction: 1 },\n    label: 0,\n  },\n  right: {\n    icon: <ArrowRightOutlined />,\n    name: \"右转弯\",\n    action: { speed: 1, direction: -1 },\n    label: 1,\n  },\n  forward: {\n    icon: <ArrowUpOutlined />,\n    name: \"前进\",\n    action: { speed: 1, direction: 0 },\n    label: 2,\n  },\n  back: {\n    icon: <ArrowDownOutlined />,\n    action: { speed: -1, direction: 0 },\n    name: \"后退\",\n    label: 3,\n  },\n  stop: {\n    icon: <PauseOutlined />,\n    action: { speed: 0, direction: 0 },\n    name: \"停止\",\n    label: 4,\n  },\n};\n\nexport default class AiSample extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      sampleList: props.sampleList || [],\n      exportName: \"自动驾驶学习样本\",\n    };\n  }\n\n  componentDidMount() {\n    this.props.controller.changeCamera(true);\n  }\n\n  async add(example) {\n    const {\n      props: { canvasRef },\n    } = this;\n    const { sampleList } = this.state;\n    sampleList.unshift({\n      ...example,\n      img: await getImageUrl(canvasRef),\n    });\n    this.setState({ sampleList });\n  }\n\n  update(index, action) {\n    this.setState((state) => {\n      state.sampleList[index].action = action;\n      return state;\n    });\n  }\n\n  remove(index) {\n    const { sampleList } = this.state;\n    sampleList.splice(index, 1);\n    this.setState({ sampleList });\n  }\n\n  clear = () => {\n    this.setState({ sampleList: [] });\n  };\n\n  upload = ({ file, onSuccess }) => {\n    const reader = new FileReader();\n    reader.onload = ({ target: { result } }) => {\n      const data = JSON.parse(result);\n      const { sampleList } = this.state;\n      this.setState({\n        sampleList: sampleList.concat(data),\n      });\n      onSuccess();\n    };\n    reader.readAsText(file);\n    return true;\n  };\n\n  download = () => {\n    const { sampleList, exportName } = this.state;\n    saveAs(new Blob([JSON.stringify(sampleList)]), `${exportName}.json`);\n  };\n\n  render() {\n    const {\n      clear,\n      download,\n      upload,\n      props: { onFinish, cameraEnabled },\n    } = this;\n    const { sampleList } = this.state;\n    return (\n      <div className=\"ai-sample\">\n        <Form layout=\"inline\" className=\"ai-sample-form\">\n          {Object.keys(aiAction).map((key) => (\n            <Form.Item>\n              <Button\n                icon={aiAction[key].icon}\n                onClick={() => this.add({ action: key })}\n                disabled={!cameraEnabled}\n              >{aiAction[key].name}</Button>\n            </Form.Item>\n          ))}\n          <Form.Item>\n            <Upload\n              customRequest={upload}\n              accept=\"application/json\"\n              showUploadList={false}\n            >\n              <Button icon={<ImportOutlined />}>导入</Button>\n            </Upload>\n          </Form.Item>\n          <Form.Item>\n            <Button\n              icon={<ExportOutlined />}\n              disabled={!sampleList.length}\n              onClick={download}\n            >\n              导出\n            </Button>\n          </Form.Item>\n          <Form.Item>\n            <Button type=\"danger\" disabled={!sampleList.length} onClick={clear}>\n              清除\n            </Button>\n          </Form.Item>\n          <Form.Item>\n            <Link to=\"../train\">\n              <Button\n                type=\"primary\"\n                disabled={sampleList.length < 10}\n                onClick={() => {\n                  onFinish(sampleList);\n                }}\n              >\n                下一步\n              </Button>\n            </Link>\n          </Form.Item>\n        </Form>\n        <List\n          size=\"small\"\n          className=\"ai-example-list\"\n          grid={{ gutter: 16, column: 4 }}\n          itemLayout=\"vertical\"\n          pagination={{\n            pageSize: 12,\n          }}\n          dataSource={sampleList}\n          renderItem={({ img, action }, index) => (\n            <List.Item>\n              <Card\n                size=\"small\"\n                title={aiAction[action].icon}\n                actions={[\n                  <Button\n                    size=\"small\"\n                    icon={<CloseOutlined />}\n                    type=\"danger\"\n                    onClick={() => this.remove(index)}\n                  />,\n                ]}\n              >\n                <img\n                  style={{ width: \"100%\" }}\n                  src={img}\n                  alt=\"example\"\n                  onLoad={function ({ target }) {\n                    target.height = target.width * 0.75;\n                  }}\n                />\n              </Card>\n            </List.Item>\n          )}\n        />\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { Form, Button, Tag, InputNumber, message } from \"antd\";\nimport {\n  ImportOutlined,\n  CarOutlined,\n  StopOutlined,\n  BugOutlined,\n} from \"@ant-design/icons\";\nimport { aiAction } from \"./AiSample\";\nimport { sleep } from \"../unit\";\n\nexport default class AiDrive extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isPredicting: false,\n      actionKey: \"stop\",\n      interval: 200,\n      probability: 0,\n    };\n  }\n\n  componentDidMount() {\n    this.props.controller.changeCamera(true);\n  }\n\n  labelToKey(label) {\n    return Object.keys(aiAction).find((key) => aiAction[key].label === label);\n  }\n\n  predict = (doSometing = () => {}) => {\n    const { ai, onAi = () => {}, canvasRef } = this.props;\n    onAi(true);\n    this.setState({ isPredicting: true }, async () => {\n      while (this.state.isPredicting) {\n        const { label, probability } = await ai.predict(canvasRef);\n        const actionKey = this.labelToKey(label);\n        this.setState({ actionKey, probability });\n        doSometing(actionKey);\n        await sleep(this.state.interval);\n      }\n      onAi(false);\n    });\n  };\n\n  test = () => {\n    this.predict();\n  };\n  drive = () => {\n    this.predict((actionKey) => {\n      const { speed, direction } = this.props.controller;\n      const action = aiAction[actionKey].action;\n      speed(0);\n      speed(action.speed);\n      direction(action.direction);\n    });\n  };\n  stop = () => {\n    this.setState({ isPredicting: false });\n  };\n  loadModel = async () => {\n    await this.props.ai.load(\"test\");\n    message.success(\"模型已经加载！\");\n  };\n  downloadModel = () => {};\n  render() {\n    const {\n      state: { isPredicting, actionKey, probability, interval },\n      props: { cameraEnabled, ai },\n      drive,\n      stop,\n      test,\n      loadModel,\n    } = this;\n    return (\n      <div className=\"ai-train\">\n        <Form layout=\"inline\">\n          <Form.Item label=\"操作间隔\">\n            <InputNumber\n              value={interval}\n              onChange={(interval) => this.setState({ interval })}\n            />\n          </Form.Item>\n          <Form.Item label=\"动作\">\n            <Tag>\n              {aiAction[actionKey].name} {aiAction[actionKey].icon}{\" \"}\n              {probability.toFixed(2)}\n            </Tag>\n          </Form.Item>\n        </Form>\n        <br />\n        <Form layout=\"inline\">\n          <Form.Item>\n            <Button\n              icon={<ImportOutlined />}\n              loading={isPredicting}\n              onClick={loadModel}\n            >\n              导入模型\n            </Button>\n          </Form.Item>\n          <Form.Item>\n            <Button\n              icon={<BugOutlined />}\n              loading={isPredicting}\n              onClick={test}\n              disabled={!cameraEnabled || !ai || !ai.model}\n            >\n              测试\n            </Button>\n            &nbsp;&nbsp;&nbsp;&nbsp;\n            <Button\n              type=\"danger\"\n              key=\"predic\"\n              loading={isPredicting}\n              onClick={drive}\n              icon={<CarOutlined />}\n              disabled={!cameraEnabled || !ai || !ai.model}\n            >\n              开始 Ai 驾驶\n            </Button>\n          </Form.Item>\n\n          <Form.Item>\n            <Button\n              onClick={stop}\n              icon={<StopOutlined />}\n              disabled={!isPredicting}\n              key=\"stop\"\n            >\n              停止 Ai 驾驶\n            </Button>\n          </Form.Item>\n          <br />\n        </Form>\n      </div>\n    );\n  }\n}\n","import React, { Component, createRef } from \"react\";\nimport { Form, Button, Spin, InputNumber, Select, message } from \"antd\";\nimport { layout, tailLayout } from \"../unit\";\nimport { Link } from \"@reach/router\";\nimport { ExportOutlined, ReadOutlined } from \"@ant-design/icons\";\nimport { aiAction } from \"./AiSample\";\n\nconst { Option } = Select;\nexport default class AiTrain extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      learnArgument: {\n        learnRate: 0.0001,\n        batchSize: 0.4,\n        epochs: 20,\n        hiddenUnits: 100,\n      },\n      loss: undefined,\n      loading: false,\n      model: undefined,\n    };\n\n    this.smallCanvasRef = createRef();\n  }\n\n  componentDidMount() {\n    this.props.controller.changeCamera(false);\n  }\n\n  train = async (learnArgument) => {\n    const {\n      props: { sampleList, ai },\n    } = this;\n    this.setState({ loading: \"数据处理...\" });\n    ai.clean();\n    for (let index = 0; index < sampleList.length; index++) {\n      const { img: url, action } = sampleList[index];\n      await ai.addExample(url, aiAction[action].label);\n    }\n    this.setState({ loading: \"训练...\" });\n    await ai.train(learnArgument, (loss) => this.setState({ loss }));\n    this.setState({ loading: false });\n  };\n\n  render() {\n    const {\n      state: { learnArgument, loss, loading },\n      props: { sampleList, ai },\n      train,\n    } = this;\n    return (\n      <div className=\"ai-train\">\n        <Spin spinning={loading} tip={loading}>\n          <Form {...layout} initialValues={learnArgument} onFinish={train}>\n            <Form.Item label=\"Learning rate\" name=\"learnRate\">\n              <Select>\n                <Option value={0.00001}>0.00001</Option>\n                <Option value={0.0001}>0.0001</Option>\n                <Option value={0.001}>0.001</Option>\n                <Option value={0.003}>0.003</Option>\n              </Select>\n            </Form.Item>\n            <Form.Item label=\"Batch Size\" name=\"batchSize\">\n              <Select>\n                <Option value={0.05}>0.05</Option>\n                <Option value={0.1}>0.1</Option>\n                <Option value={0.4}>0.4</Option>\n                <Option value={1}>1</Option>\n              </Select>\n            </Form.Item>\n            <Form.Item label=\"Epochs\" name=\"epochs\">\n              <Select>\n                <Option value={10}>10</Option>\n                <Option value={20}>20</Option>\n                <Option value={40}>40</Option>\n              </Select>\n            </Form.Item>\n            <Form.Item label=\"Hidden units\" name=\"hiddenUnits\">\n              <Select>\n                <Option value={100}>100</Option>\n                <Option value={200}>200</Option>\n                <Option value={300}>300</Option>\n                <Option value={400}>400</Option>\n                <Option value={500}>500</Option>\n              </Select>\n            </Form.Item>\n            <Form.Item label=\"loss\">\n              <InputNumber value={loss} disabled />\n            </Form.Item>\n            <Form.Item {...tailLayout}>\n              <Button\n                key=\"fit\"\n                loading={loading}\n                disabled={!sampleList.length}\n                icon={<ReadOutlined />}\n                htmlType=\"submit\"\n              >\n                学习(样本{sampleList.length})\n              </Button>\n              &nbsp; &nbsp; &nbsp; &nbsp;\n              <Button\n                onClick={async () => {\n                  await ai.save(\"test\");\n                  message.success(\"模型已经保存\");\n                }}\n                icon={<ExportOutlined />}\n                disabled={!sampleList.length}\n              >\n                导出模型\n              </Button>\n            </Form.Item>\n          </Form>\n          <Form>\n            <Form.Item {...tailLayout}>\n              <Link to=\"../drive\">\n                <Button type=\"primary\" disabled={!ai || !ai.model}>\n                  下一步\n                </Button>\n              </Link>\n            </Form.Item>\n          </Form>\n        </Spin>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { Menu, Spin } from \"antd\";\nimport { Router, Link, Match } from \"@reach/router\";\nimport AiDrive from \"./AiDrive\";\nimport AiSample from \"./AiSample\";\nimport AiTrain from \"./AiTrain\";\nimport { Ai } from \"../unit\";\n\n\nconst menu = [\n  { key: \"sample\", name: \"采集样本\" },\n  { key: \"train\", name: \"学习训练\" },\n  { key: \"drive\", name: \"自动驾驶\" },\n];\n\nexport default class AiView extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      learnForm: {},\n      exampleList: [],\n      sampleList: [],\n      loading: false,\n      isPredicting: false,\n      loss: 0,\n    };\n  }\n\n  async componentDidMount() {\n    this.setState({ loading: \"加载 MobileNet...\" });\n    const ai = await new Ai();\n    this.setState({ loading: false, ai });\n  }\n\n\n  menuItem = ({ key, name }) => {\n    return (\n      <Menu.Item key={key}>\n        <Link to={`./${key}`}>{name}</Link>\n      </Menu.Item>\n    );\n  };\n\n  render() {\n    const {\n      state: { sampleList, ai, loading },\n      props: { controller, cameraEnabled, canvasRef },\n      menuItem,\n    } = this;\n\n    return (\n      <Spin spinning={loading} tip={loading}>\n        <Match path=\":current\">\n          {(props) => (\n            <Menu\n              selectedKeys={[props.match && props.match.current]}\n              mode=\"horizontal\"\n            >\n              {menu.map((i) => menuItem(i))}\n            </Menu>\n          )}\n        </Match>\n        <Router>\n          <AiSample\n            path=\"sample\"\n            onFinish={(sampleList) => this.setState({ sampleList })}\n            sampleList={sampleList}\n            canvasRef={canvasRef}\n            cameraEnabled={cameraEnabled}\n            controller={controller}\n          />\n          <AiTrain\n            path=\"train\"\n            sampleList={sampleList}\n            controller={controller}\n            ai={ai}\n          />\n          <AiDrive\n            path=\"drive\"\n            controller={controller}\n            canvasRef={canvasRef}\n            cameraEnabled={cameraEnabled}\n            ai={ai}\n          />\n        </Router>\n      </Spin>\n    );\n  }\n}\n","import * as cocoSsd from \"@tensorflow-models/coco-ssd\";\nexport default class CocoSSD {\n  constructor() {\n    return (async () => {\n      this.model = await cocoSsd.load({\n        base: \"lite_mobilenet_v2\",\n      });\n      console.log(\"model loaded\");\n      return this;\n    })();\n  }\n\n  async predict(image) {\n    console.time(\"predict1\");\n    const result = await this.model.detect(image);\n    console.timeEnd(\"predict1\");\n    console.log(result);\n    return result;\n  }\n}\n","import React, { Component, createRef } from \"react\";\nimport CocoSSD from \"../lib/CocoSSD\";\nimport { Spin, Button, Form, InputNumber, Select } from \"antd\";\nimport { sleep } from \"../unit\";\nimport { CarOutlined, StopOutlined } from \"@ant-design/icons\";\n\nexport default class ObjectDetection extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: false,\n      targetClass: undefined,\n      threshold: 0.5,\n      detectionList: [],\n      interval: 200,\n      driving: false,\n      detecting: false,\n    };\n    this.canvas = createRef();\n  }\n  async componentDidMount() {\n    this.setState({ loading: \"加载模型...\" });\n    this.cocoSSD = await new CocoSSD();\n    this.setState({ loading: false });\n    this.props.controller.changeCamera(true);\n  }\n\n  detect = async () => {\n    const {\n      state: { targetClass, threshold, detectionList },\n      props: { canvasRef, cameraEnabled },\n      draw,\n    } = this;\n    if (!cameraEnabled) return;\n    const result = await this.cocoSSD.predict(canvasRef);\n    let target;\n    result.forEach((i) => {\n      if (!detectionList.some((c) => i.class == c)) {\n        detectionList.push(i.class);\n      }\n      if (targetClass && i.class == targetClass && i.score > threshold) {\n        if (!target) {\n          target = i;\n        } else {\n          if (target.score < i.score) {\n            target = i;\n          }\n        }\n      }\n    });\n    draw(result, target);\n    return target;\n  };\n\n  draw = (result, target) => {\n    const { canvas } = this;\n    const context = canvas.current.getContext(\"2d\");\n    // context.drawImage(image, 0, 0);\n    context.clearRect(0, 0, canvas.current.width, canvas.current.height);\n    context.font = \"10px Arial\";\n\n    console.log(\"number of detections: \", result.length);\n    for (let i = 0; i < result.length; i++) {\n      context.beginPath();\n      context.rect(...result[i].bbox);\n      context.lineWidth = 1;\n      context.strokeStyle = result[i] === target ? \"red\" : \"green\";\n      context.fillStyle = result[i] === target ? \"red\" : \"green\";\n      context.stroke();\n      context.fillText(\n        result[i].score.toFixed(3) + \" \" + result[i].class,\n        result[i].bbox[0],\n        result[i].bbox[1] > 10 ? result[i].bbox[1] - 5 : 10\n      );\n    }\n  };\n\n  startDetect = async () => {\n    this.setState({ detecting: true }, async () => {\n      while (this.state.detecting) {\n        const target = await this.detect();\n        if (this.state.driving) {\n          this.drive(target);\n        }\n        await sleep(this.state.interval);\n      }\n    });\n  };\n\n  drive = async (target) => {\n    const {\n      props: {\n        canvasRef,\n        controller: { speed, direction },\n      },\n    } = this;\n    const { width, height } = canvasRef;\n    if (!target) {\n      speed(0);\n      return;\n    }\n    const {\n      bbox: [x, y, w, h],\n    } = target;\n    const c = x + w / 2;\n    if (w > 100) {\n      speed(-1);\n    } else {\n      speed(1);\n    }\n\n    if (c > 250) {\n      direction(-1);\n    } else if (c < 150) {\n      direction(1);\n    } else {\n      direction(0);\n    }\n  };\n\n  start = () => {\n    this.setState({ driving: true });\n    this.props.onAi(true);\n  };\n  stop = () => {\n    this.setState({ driving: false });\n    this.props.controller.speed(0);\n    this.props.onAi(false);\n  };\n\n  render() {\n    const {\n      state: { loading, threshold, interval, detectionList, targetClass },\n      props: { videoSize, cameraEnabled },\n      startDetect,\n      start,\n      stop,\n    } = this;\n    return (\n      <div className=\"ai-object-detection\">\n        <Spin spinning={loading} tip={loading}>\n          <Form layout=\"inline\" style={{ padding: \"1em\" }}>\n            <Form.Item label=\"目标\">\n              <Select\n                value={targetClass}\n                onChange={(targetClass) => this.setState({ targetClass })}\n                style={{ width: \"10vw\" }}\n              >\n                {detectionList.map((i) => (\n                  <Select.Option value={i}>{i}</Select.Option>\n                ))}\n              </Select>\n            </Form.Item>\n            <Form.Item label=\"阀值\">\n              <InputNumber\n                value={threshold}\n                onChange={(threshold) => this.setState({ threshold })}\n              />\n            </Form.Item>\n            <Form.Item label=\"间隔\">\n              <InputNumber\n                value={interval}\n                onChange={(interval) => this.setState({ interval })}\n              />\n            </Form.Item>\n            <Form.Item>\n              <Button onClick={startDetect}>开始检测</Button>\n            </Form.Item>\n            <Form.Item>\n              <Button icon={<CarOutlined />} type=\"danger\" onClick={start}>\n                开始驾驶\n              </Button>\n            </Form.Item>\n            <Form.Item>\n              <Button icon={<StopOutlined />} onClick={stop}>\n                停止驾驶\n              </Button>\n            </Form.Item>\n          </Form>\n        </Spin>\n        <div\n          className=\"ai-object-detection-canvas-container\"\n          style={{\n            opacity: cameraEnabled ? 1 : 0,\n            transform: `scale(${videoSize / 50})`,\n          }}\n        >\n          <canvas ref={this.canvas} width=\"400\" height=\"300\"></canvas>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport { Slider, Form, Button, Input, Select } from \"antd\";\nimport { layout, tailLayout } from \"../unit\";\n\nconst { Option } = Select;\n\nexport default function Setting({\n  onDisconnect,\n  wsConnected,\n  onSubmit,\n  serverSetting,\n  ...form\n}) {\n  return (\n    <Form {...layout} onFinish={onSubmit} initialValues={form}>\n      <br />\n      <Form.Item\n        label=\"连接地址\"\n        name=\"wsAddress\"\n        rules={[{ required: true, message: \"请输入连接地址!\" }]}\n      >\n        <Input />\n      </Form.Item>\n      <Form.Item label=\"最大速度\" name=\"speedMax\">\n        <Slider min={0} max={serverSetting.maxSpeed} tooltipVisible />\n      </Form.Item>\n      <Form.Item label=\"摄像头模式\" name=\"cameraMode\">\n        <Select>\n          <Option value=\"default\">300p-30fps(默认)</Option>\n          <Option value=\"480p-15fps\">480p-15fps</Option>\n          <Option value=\"600p\">600p-30fps</Option>\n          {/* <Option value=\"1080p\">1080p-30fps</Option> */}\n        </Select>\n      </Form.Item>\n      <Form.Item {...tailLayout}>\n        <Button type=\"primary\" htmlType=\"submit\">\n          保存\n        </Button>\n      </Form.Item>\n    </Form>\n  );\n}\n","import React from \"react\";\nimport { layout, tailLayout } from \"../unit\";\nimport { Input, Button, Form } from \"antd\";\n\nexport default function Login({ onSubmit }) {\n  return (\n    <Form {...layout} onFinish={onSubmit}>\n      <Form.Item label=\"密码\" name=\"password\">\n        <Input type=\"password\" />\n      </Form.Item>\n      <Form.Item {...tailLayout}>\n        <Button type=\"primary\" htmlType=\"submit\">\n          登录\n        </Button>\n      </Form.Item>\n    </Form>\n  );\n}\n","import React, { Component, createRef } from \"react\";\nimport WakeLock from \"react-wakelock-react16\";\nimport store from \"store\";\nimport {\n  Form,\n  Switch,\n  Dropdown,\n  Button,\n  Popover,\n  message,\n  Slider,\n  Tag,\n} from \"antd\";\nimport \"./App.css\";\nimport { Router, Location, navigate } from \"@reach/router\";\nimport Nav from \"./components/Nav\";\nimport Controller from \"./components/Controller\";\nimport Setting from \"./components/Setting\";\nimport WSAvcPlayer from \"ws-avc-player\";\nimport {\n  HomeOutlined,\n  ExpandOutlined,\n  FullscreenOutlined,\n  ApiOutlined,\n  VideoCameraOutlined,\n  BulbOutlined,\n  FullscreenExitOutlined,\n} from \"@ant-design/icons\";\nimport Login from \"./components/Login\";\nimport md5 from \"md5\";\nimport debounce from \"debounce\";\n\nconst pubilcUrl = process.env.PUBLIC_URL;\n\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n    this.appRef = createRef();\n    this.playerBoxRef = createRef();\n    this.state = {\n      setting: {\n        speedMax: 20,\n        wsAddress: window.location.host,\n        cameraMode: \"default\",\n        ...store.get(\"setting\"),\n      },\n      serverSetting: {\n        maxSpeed: 100,\n      },\n      wsConnected: false,\n      cameraEnabled: false,\n      lightEnabled: false,\n      canvasRef: undefined,\n      isAiControlling: false,\n      isFullscreen: false,\n      videoSize: 50,\n      delay: undefined,\n      action: {\n        speed: 0,\n        direction: 0,\n      },\n    };\n\n    const { changeCamera, changeLight } = this;\n\n    this.controller = {\n      changeLight,\n      changeCamera,\n      speed: (v) => {\n        const {\n          changeSpeed,\n          state: {\n            setting: { speedMax },\n            action,\n          },\n        } = this;\n        // let vAbs = Math.abs(v);\n        // if (vAbs > speedMax / 100) {\n        //   vAbs = speedMax / 100;\n        // }\n        // action.speed = v > 0 ? vAbs : -vAbs;\n        action.speed = (v * speedMax) / 100;\n        this.setState({ action: { ...action } });\n        changeSpeed(action.speed);\n      },\n      direction: (v) => {\n        const {\n          changeDirection,\n          state: { action },\n        } = this;\n        action.direction = v;\n        changeDirection(v);\n        this.setState({ action: { ...action } });\n      },\n    };\n\n    this.changeVideoSize = debounce(() => {\n      this.setState({ unbounceVideoSize: this.state });\n    }, 300);\n  }\n\n  componentDidMount() {\n    const { connect } = this;\n    let pingTime;\n    this.wsavc = new WSAvcPlayer({\n      useWorker: true,\n      workerFile: `${process.env.PUBLIC_URL}/Decoder.js`,\n    });\n\n    this.wsavc.on(\"pong\", ({ sendTime }) => {\n      this.setState({ delay: (new Date().getTime() - sendTime) / 2 });\n    });\n\n    this.wsavc.on(\"controller init\", ({ needPassword, maxSpeed }) => {\n      this.setState({ serverSetting: { maxSpeed, needPassword } });\n      if (needPassword) {\n        navigate(`${pubilcUrl}/login`);\n      }\n    });\n\n    this.wsavc.on(\"disconnected\", () => {\n      console.log(\"WS disconnected\");\n      this.setState({ wsConnected: false, cameraEnabled: false });\n      clearInterval(pingTime);\n    });\n    this.wsavc.on(\"connected\", () => {\n      console.log(\"WS connected\");\n      this.setState({ wsConnected: true });\n      pingTime = setInterval(() => {\n        const sendTime = new Date().getTime();\n        this.wsavc.send(\"ping\", { sendTime });\n      }, 1000);\n    });\n    this.wsavc.on(\"frame_shift\", (fbl) => {\n      // console.log(\"Stream frame shift: \", fbl);\n    });\n    this.wsavc.on(\"resized\", (payload) => {\n      console.log(\"resized\", payload);\n    });\n    this.wsavc.on(\"stream_active\", (cameraEnabled) => {\n      console.log(\"Stream is \", cameraEnabled ? \"active\" : \"offline\");\n      if (cameraEnabled) {\n        this.playerBoxRef.current.appendChild(this.wsavc.AvcPlayer.canvas);\n        this.setState({\n          cameraEnabled,\n          canvasRef: this.wsavc.AvcPlayer.canvas,\n        });\n      } else {\n        this.setState({ cameraEnabled, canvasRef: undefined });\n      }\n    });\n\n    this.wsavc.on(\"light enabled\", (lightEnabled) => {\n      this.setState({ lightEnabled });\n    });\n\n    this.wsavc.on(\"login\", ({ message: m }) => {\n      message.success(m);\n      navigate(`${pubilcUrl}/`);\n    });\n\n    this.wsavc.on(\"error\", ({ message: m }) => {\n      message.error(m);\n    });\n\n    connect();\n\n    document.body.addEventListener(\"fullscreenchange\", () => {\n      if (document.fullscreenElement) {\n        this.setState({ isFullscreen: true });\n      } else {\n        this.setState({ isFullscreen: false });\n      }\n    });\n  }\n\n  connect = () => {\n    const { wsAddress } = this.state.setting;\n    this.wsavc.connect(\n      `${\n        window.location.protocol === \"https:\" ? \"wss://\" : \"ws://\"\n      }${wsAddress}`\n    );\n  };\n\n  disconnect = (e) => {\n    e && e.preventDefault();\n    this.setState({ wsConnected: false });\n    if (!this.wsavc) return;\n    this.wsavc.disconnect();\n  };\n\n  login = ({ password }) => {\n    const { wsConnected } = this.state;\n    if (!wsConnected) return;\n    this.wsavc.send(\"login\", {\n      token: md5(`${password}eson`),\n    });\n  };\n\n  changeCamera = (enabled) => {\n    const {\n      state: {\n        setting: { cameraMode },\n        wsConnected,\n      },\n    } = this;\n    if (!wsConnected) return;\n    this.wsavc.send(\"open camera\", { enabled, cameraMode });\n  };\n\n  changeLight = (enable) => {\n    const { wsConnected } = this.state;\n    if (!wsConnected) return;\n    this.wsavc.send(\"open light\", enable);\n  };\n\n  changeSetting = (setting) => {\n    this.setState({ setting });\n    store.set(\"setting\", setting);\n    navigate(`${pubilcUrl}/`);\n\n    // this.connect();\n  };\n\n  changeZeroSpeedRate = (speedZeroRate) => {\n    if (!this.state.wsConnected) return;\n    this.wsavc.send(\"speed zero rate\", speedZeroRate);\n    this.setState({ speedZeroRate });\n  };\n\n  changeSpeed = (speedRate) => {\n    if (!this.state.wsConnected) return;\n    this.wsavc.send(\"speed rate\", speedRate);\n  };\n\n  changeDirection = (directionRate) => {\n    if (!this.state.wsConnected) return;\n    this.wsavc.send(\"direction rate\", directionRate);\n  };\n\n  render() {\n    const {\n      disconnect,\n      connect,\n      controller,\n      changeSetting,\n      changeLight,\n      changeCamera,\n      login,\n      state: {\n        setting,\n        wsConnected,\n        cameraEnabled,\n        canvasRef,\n        action,\n        isFullscreen,\n        serverSetting,\n        lightEnabled,\n        videoSize,\n        delay,\n      },\n    } = this;\n    return (\n      <div className=\"App\" ref={this.appRef}>\n        <Form layout=\"inline\" className=\"app-status\" size=\"small\">\n          <Form.Item>\n            <Location>\n              {({ navigate }) => (\n                <Dropdown.Button\n                  overlay={Nav}\n                  onClick={() => navigate(`${process.env.PUBLIC_URL}/`)}\n                  type=\"primary\"\n                >\n                  <HomeOutlined /> 控制\n                </Dropdown.Button>\n              )}\n            </Location>\n          </Form.Item>\n          <Form.Item>\n            <Switch\n              checked={wsConnected}\n              onChange={(v) => {\n                if (v) connect();\n                else disconnect();\n              }}\n              unCheckedChildren={<ApiOutlined />}\n              checkedChildren={<ApiOutlined />}\n            />\n          </Form.Item>\n          <Form.Item>\n            <Switch\n              checked={cameraEnabled}\n              onChange={changeCamera}\n              checkedChildren={<VideoCameraOutlined />}\n              unCheckedChildren={<VideoCameraOutlined />}\n            />\n          </Form.Item>\n\n          {/* <Form.Item>\n            <Button style={{ width: \"6em\" }}>\n              舵机:{action.direction.toFixed(2)}\n            </Button>\n          </Form.Item>\n          <Form.Item>\n            <Button style={{ width: \"6em\" }}>\n              电调:{action.speed.toFixed(2)}\n            </Button>\n          </Form.Item> */}\n          {cameraEnabled && (\n            <Form.Item>\n              <Popover\n                placement=\"bottomRight\"\n                content={\n                  <Slider\n                    defaultValue={videoSize}\n                    step={0.1}\n                    tipFormatter={(v) => v * 2}\n                    onAfterChange={(videoSize) => this.setState({ videoSize })}\n                    style={{ width: \"30vw\" }}\n                    marks={{ 0: 0, 50: 100, 100: 200 }}\n                  />\n                }\n              >\n                <Button shape=\"round\">\n                  <ExpandOutlined />\n                  {(videoSize * 2).toFixed(1)}%\n                </Button>\n              </Popover>\n            </Form.Item>\n          )}\n\n          <Form.Item>\n            <Switch\n              checked={lightEnabled}\n              onChange={changeLight}\n              checkedChildren={<BulbOutlined />}\n              unCheckedChildren={<BulbOutlined />}\n            />\n          </Form.Item>\n\n          {document.body.requestFullscreen && (\n            <Form.Item>\n              <Button\n                type=\"primary\"\n                shape=\"circle\"\n                icon={\n                  isFullscreen ? (\n                    <FullscreenExitOutlined />\n                  ) : (\n                    <FullscreenOutlined />\n                  )\n                }\n                onClick={() => {\n                  if (isFullscreen) {\n                    document.exitFullscreen();\n                  } else {\n                    document.body.requestFullscreen();\n                  }\n                }}\n              ></Button>\n            </Form.Item>\n          )}\n          {wsConnected && delay && (\n            <Form.Item>\n              <Tag color={delay > 80 ? \"red\" : \"green\"}>ping:{delay}</Tag>\n            </Form.Item>\n          )}\n        </Form>\n\n        <Router className=\"app-page\">\n          <Setting\n            path={`${process.env.PUBLIC_URL}/setting`}\n            {...setting}\n            serverSetting={serverSetting}\n            wsConnected={wsConnected}\n            onDisconnect={disconnect}\n            onSubmit={changeSetting}\n          />\n          <Login path={`${process.env.PUBLIC_URL}/login`} onSubmit={login} />\n          <Controller\n            path={`${process.env.PUBLIC_URL}/*`}\n            controller={controller}\n            lightEnabled={lightEnabled}\n            cameraEnabled={cameraEnabled}\n            canvasRef={canvasRef}\n            action={action}\n            videoSize={videoSize}\n          ></Controller>\n        </Router>\n        <div\n          className=\"player-box\"\n          ref={this.playerBoxRef}\n          style={{\n            opacity: cameraEnabled ? 1 : 0,\n            transform: `scale(${videoSize / 50})`,\n          }}\n        ></div>\n        <WakeLock preventSleep={wsConnected} />\n      </div>\n    );\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}