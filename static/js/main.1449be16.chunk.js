(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{147:function(e,t,a){e.exports=a(323)},152:function(e,t,a){},163:function(e,t,a){},323:function(e,t,a){"use strict";a.r(t);var n,c=a(0),s=a.n(c),r=a(8),o=a.n(r),l=(a(152),a(102)),i=a(45),d=a(46),m=a(28),p=a(49),u=a(50),h=a(19),v=a.n(h),b=a(332),f=a(333),E=a(334),w=a(335),g=a(329),y=a(327),R=a(326),k=a(331),S=a(101),C=a(328),x=a(330),j=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).keyboardBind=function(){var e=Object(m.a)(n).props.controller,t=e.speed,a=e.direction;n.ref.current.addEventListener("keydown",(function(e){var n=e.key;"w"===n&&t(1),"s"===n&&t(-1),"a"===n&&a(1),"d"===n&&a(-1)}),!1),n.ref.current.addEventListener("keyup",(function(e){var t=Object(m.a)(n).props.controller,a=t.speed,c=t.direction,s=e.key;"w"===s&&a(0),"s"===s&&a(0),"a"===s&&c(0),"d"===s&&c(0)}),!1)},n.ref=Object(c.createRef)(),n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.keyboardBind()}},{key:"render",value:function(){return s.a.createElement("div",{tabIndex:"0",ref:this.ref},"wads")}}]),a}(c.Component),M=(a(163),function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).canvasRef=Object(c.createRef)(),n}return Object(d.a)(a,[{key:"componentWillReceiveProps",value:function(e){e.disabled!==this.props.disabled&&(e.disabled?this.disconnect():this.connect())}},{key:"connect",value:function(){var e=this,t=this.props.address;t&&(this.wsavc=new window.WSAvcPlayer(this.canvasRef.current,"webgl",1,35),this.wsavc.connect("".concat("https:"===window.location.protocol?"wss":"ws","://").concat(t),(function(){e.wsavc.playStream()})))}},{key:"disconnect",value:function(){this.wsavc&&(this.wsavc.disconnect(),this.wsavc=void 0)}},{key:"render",value:function(){return s.a.createElement("div",{className:"player"},s.a.createElement("canvas",{className:"canvas",ref:this.canvasRef}))}}]),a}(c.Component)),O=g.a.TabPane;window.addEventListener("deviceorientation",(function(e){var t=e.alpha,a=e.beta,c=e.gamma;n={alpha:t,beta:a,gamma:c}}));var W={labelCol:{span:6},wrapperCol:{span:16}},A={wrapperCol:{offset:4,span:16}},I={0:"0%",25:"25%",50:"50%",75:"75%",100:"100%"},Z=function(e){Object(u.a)(a,e);var t=Object(p.a)(a);function a(e){var c;return Object(i.a)(this,a),(c=t.call(this,e)).deviceorientation=function(){var e=Object(m.a)(c),t=(e.changeSpeed,e.changeDirection),a=e.state,s=(a.hold,a.base),r=(s.gamma,s.beta),o=a.directionReverse,l=(a.speedZeroRate,a.speedMaxRate,a.speedReverseMaxRate,n.beta-r);l=(l=l<-30?-30:l)>30?30:l,t(5*(o?-l/30:l/30)+7.5)},c.connectWs=function(e){var t=e.wsAddress,a=e.playerWsAddress;t&&(c.socket&&(c.socket.close(),c.socket=void 0),c.socket=window.io(t),c.socket.on("connect",(function(){c.setState({wsConnected:!0}),c.changeZeroSpeedRate(c.state.speedZeroRate),v.a.set("wsAddress",t)})),c.socket.on("disconnect",(function(){c.setState({wsConnected:!1})})),a&&(c.setState({playerWsAddress:a}),v.a.set("playerWsAddress",a)))},c.disconnectWs=function(e){e&&e.preventDefault(),c.socket.close()},c.handleHold=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e||(c.socket.emit("speed rate",0),c.socket.emit("direction rate",0)),c.setState({hold:e,base:Object(l.a)({},n)})},c.changeZeroSpeedRate=function(e){c.state.wsConnected&&(c.socket.emit("speed zero rate",e),c.setState({speedZeroRate:e}))},c.changeSpeed=function(e){c.state.wsConnected&&(c.socket.emit("speed rate",e),c.setState({speedRate:e}))},c.changeDirection=function(e){c.state.wsConnected&&(c.socket.emit("direction rate",e),c.setState({direction:e}))},c.appRef=s.a.createRef(),c.state={hold:!1,speed:0,direction:0,base:{alpha:void 0,beta:void 0,gamma:void 0},speedMaxRate:v.a.get("speedMaxRate")||80,speedReverseMaxRate:v.a.get("speedReverseMaxRate")||70,speedZeroRate:v.a.get("speedZeroRate")||75,speedRate:0,directionReverse:v.a.get("directionReverse")||!0,wsConnected:!1,wsAddress:v.a.get("wsAddress"),playerWsAddress:v.a.get("playerWsAddress"),playerEnabled:!1},c.controller={speed:function(e){var t=Object(m.a)(c),a=t.changeSpeed,n=t.state,s=n.speedMaxRate,r=n.speedReverseMaxRate,o=n.speedZeroRate;a(e>0?o+(s-o)*e:o+(o-r)*e)},direction:function(e){(0,Object(m.a)(c).changeDirection)(5*e+7.5)}},c}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this.deviceorientation,t=this.connectWs,a=this.state.wsAddress;window.addEventListener("deviceorientation",(function(){e()}),!1),t({wsAddress:a})}},{key:"render",value:function(){var e=this,t=this.connectWs,a=this.disconnectWs,c=this.changeSpeed,r=this.changeDirection,o=this.controller,i=this.state,d=i.wsConnected,m=i.directionReverse,p=i.direction,u=i.speedReverseMaxRate,h=i.speedMaxRate,Z=i.speedZeroRate,N=i.speedRate,P=i.wsAddress,D=i.playerWsAddress,T=i.playerEnabled;return s.a.createElement("div",{className:"App",ref:this.appRef},s.a.createElement(y.a,{layout:"inline",className:"status",size:"small"},s.a.createElement(y.a.Item,{label:"\u8fde\u63a5\u72b6\u6001"},s.a.createElement(R.a,{checked:d,disabled:!0})),s.a.createElement(y.a.Item,{label:"\u8235\u673a PWM"},s.a.createElement(k.a,{style:{margin:"0 16px"},value:p,onChange:r})),s.a.createElement(y.a.Item,{label:"\u7535\u8c03 PWM"},s.a.createElement(k.a,{style:{margin:"0 16px"},value:N,onChange:c})),s.a.createElement(y.a.Item,{label:"\u5168\u5c4f"},s.a.createElement(S.a,{type:"primary",shape:"circle",icon:s.a.createElement(b.a,null),onClick:function(){e.appRef.current.requestFullscreen()}}))),s.a.createElement(g.a,null,s.a.createElement(O,{tab:"\u63a7\u5236",key:1,className:"control-pane"},s.a.createElement(y.a,{className:"controller",size:"small",layout:"inline"},s.a.createElement(y.a.Item,null,s.a.createElement(S.a,{type:"danger",onClick:function(){e.setState({base:Object(l.a)({},n)})},icon:s.a.createElement(f.a,null)},"\u8235\u673a\u6821\u51c6")),s.a.createElement(y.a.Item,{label:"\u8235\u673a\u53cd\u5411"},s.a.createElement(R.a,{checked:m,onChange:function(t){e.setState({directionReverse:t})}}))),s.a.createElement(S.a,{className:"forward-button",shape:"circle",size:"large",type:"primary",onTouchStart:function(){e.setState({hold:!0}),e.changeSpeed(h)},onTouchEnd:function(){e.setState({hold:!1}),e.changeSpeed(Z)},icon:s.a.createElement(E.a,null)}),s.a.createElement(S.a,{className:"backward-button",shape:"circle",size:"large",type:"primary",onTouchStart:function(){e.setState({hold:!0}),e.changeSpeed(u)},onTouchEnd:function(){e.setState({hold:!1}),e.changeSpeed(Z)},icon:s.a.createElement(w.a,null)})),s.a.createElement(O,{tab:"\u952e\u76d8\u63a7\u5236",key:2},s.a.createElement(j,{controller:o})),s.a.createElement(O,{tab:"\u8bbe\u7f6e",key:"setting"},s.a.createElement(y.a,W,s.a.createElement(y.a.Item,{label:"\u6444\u50cf\u5934"},s.a.createElement(R.a,{checked:T,onChange:function(t){e.setState({playerEnabled:t})}})),s.a.createElement(y.a.Item,{label:"\u7535\u8c03\u65e0\u8f93\u51fa PWM \u7a7a\u5360\u6bd4"},s.a.createElement(C.a,{value:Z,min:0,max:100,onChange:function(t){e.changeZeroSpeedRate(t),v.a.set("speedZeroRate",t)},included:!1,tooltipVisible:!0,marks:I,disabled:!0})),s.a.createElement(y.a.Item,{label:"\u7535\u8c03\u6700\u5927 PWM \u7a7a\u5360\u6bd4"},s.a.createElement(C.a,{value:h,min:Z,max:100,onChange:function(t){e.setState({speedMaxRate:t}),v.a.set("speedMaxRate",t)},marks:I})),s.a.createElement(y.a.Item,{label:"\u7535\u8c03\u53cd\u5411\u6700\u5927 PWM \u7a7a\u5360\u6bd4"},s.a.createElement(C.a,{value:u,min:0,max:Z,onChange:function(t){e.setState({speedReverseMaxRate:t}),v.a.set("speedReverseMaxRate",t)},marks:I})))),s.a.createElement(O,{tab:"\u8fde\u63a5",key:3},s.a.createElement(y.a,Object.assign({},W,{onFinish:t,initialValues:{wsAddress:P,playerWsAddress:D}}),s.a.createElement("br",null),s.a.createElement(y.a.Item,{label:"\u63a7\u5236\u8fde\u63a5\u5730\u5740",name:"wsAddress",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8fde\u63a5\u5730\u5740!"}]},s.a.createElement(x.a,null)),s.a.createElement(y.a.Item,{label:"\u5a92\u4f53\u8fde\u63a5\u5730\u5740",name:"playerWsAddress"},s.a.createElement(x.a,null)),s.a.createElement(y.a.Item,A,d?s.a.createElement(S.a,{type:"danger",onClick:a},"\u65ad\u5f00"):s.a.createElement(S.a,{type:"primary",htmlType:"submit"},"\u8fde\u63a5")))),s.a.createElement(O,{tab:"\u8c03\u8bd5",key:4},s.a.createElement(y.a.Item,{label:"\u7535\u8c03"},s.a.createElement(C.a,{value:N,min:0,max:100,onChange:c})),s.a.createElement(y.a.Item,{label:"\u8235\u673a"},s.a.createElement(C.a,{value:p,min:0,max:100,onChange:r})))),s.a.createElement(M,{disabled:!T,address:D}))}}]),a}(c.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(Z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[147,1,2]]]);
//# sourceMappingURL=main.1449be16.chunk.js.map